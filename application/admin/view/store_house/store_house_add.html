{include file="template/_meta" /}
<title></title>
</head>

{block name="css"}
<link rel="stylesheet" type="text/css" href="__STATIC__/admin/common/css/aaa.css" />
<style type="text/css">
	body {
		background: #fff;
	}
	
	#hot {
		display: flex;
		align-items: center;
		flex-wrap: wrap;
	}
	
	.list {
		margin-right: 10px;
		margin-bottom: 6px;
	}
	
	.title {
		height: 50px;
		background: #F2F2F2;
		font-size: 20px;
		line-height: 50px;
		padding-left: 20px;
		font-weight: bold;
	}
	
	.special,
	.general,
	.special .layui-form-item,
	.general .layui-form-item {
		min-width: 100%;
	}
	
	.add-content {
		background: #F2F2F2;
		width: 100%;
	}
	
	.general-kuang {
		border: solid 1px #E4E4E4;
		width: 1000px;
		padding-left: 10px;
	}
	
	.btus {
		background: #fff;
		border: solid 1px #E4E4E4;
		color: #0099FF;
		width: 141px;
		display: inline-block;
		margin: 10px;
	}
	
	#general-content .layui-form-item {
		width: 100%;
	}
	
	.sky-blue {
		color: #0099FF;
	}
	
	.bgwhite {
		background: #fff;
	}
	
	.noshow {
		display: none;
	}
	
	.special .layui-form-item {
		width: 100%;
	}
	
	.general .layui-form-item {
		width: 100%;
	}
	
	.special .layui-form-item label {
		width: 10%;
	}
	
	.general .layui-form-item label {
		width: 10%;
	}
	
	.operation-btus {
		width: 60px;
		height: 40px;
		border-radius: 3px;
		color: #fff;
	}
	
	.btu-delet {
		background: #FF0000;
	}
	
	.btu-cancel {}
	
	.btu-add {
		background: #0099FF;
	}
	
	.num-content {
		overflow: hidden;
	}
	
	#general_content>div {
		margin-top: 6px;
	}
	/* 弹窗 */
	
	.tanchuang {
		width: 100%;
		min-height: 1000px;
		background: RGBA(0, 0, 0, 0.3);
		position: fixed;
		z-index: 9999;
    }
    .danwei{
        position: absolute;
        left: 152px;
    }
	.add_danwei{
        color: #20A0FF;
		cursor: pointer;
    }
	.delect_img {
        width: 14px;
        position: absolute;
        right: 0;
        top: 0;
    }
</style>

{/block}

<body>
	{block name="content"}
	<div class="tanchuang noshow">
		<div style="width: 395px;height: 527px;margin: 10% auto;">
			<img src="" class="tanimg" />
		</div>

	</div>

	<form class="layui-form layui-form-lists" action="{:url('admin/StoreHouse/store_house_add')}" method="post" enctype="multipart/form-data">
		<div class="form-title">基础信息 </div>
		<div class="form-item">
			<label class="form-label"> <span class="red">*</span> 仓库编号</label>
			<div class="form-input">
				<input type="text" name="number" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input" required>
				 <div class="tips">*例如：北京仓BJ</div>
			</div>
		</div>
		<div class="form-item">
			<label class="form-label"><span class="red">*</span>仓库名称</label>
			<div class="form-input">
				<input type="text" name="name" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input" required>
				
			</div>
		</div>
		<div class="form-item">
			<label class="form-label"><span class="red">*</span>仓库地址</label>
			<div class="form-input">
				<input type="text" name="adress" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input" required>
				
			</div>
		</div>
		<div class="form-item">
			<label class="form-label"><span class="red">*</span>仓库管理员</label>
			<div class="form-input">
				<input type="text" name="manager" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input" required> 
			
			</div>
		</div>
		<div class="form-item">
			<label class="form-label"><span class="red">*</span>联系电话</label>
			<div class="form-input">
				<input type="text" name="phone" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input" required>
			</div>
		</div>
        <div class="form-title">详细信息 </div>
		<div class="form-item">
			<label class="form-label"><span class="red">*</span>仓库描述</label>
			<div class="form-input">
				<input type="text" name="describe" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input" required>
				<div class="tips">*不超过20个字</div>
			</div>
		</div>
            <div class="form-item" >
				<label class="form-label"><span class="red">*</span>仓库保管费</label>
				<div class="danwei_content">
				
					<div class="add_danwei"> 继续添加单位</div>
					<div class="tips">*此处包含您添加的商品所有包装规格</div>
			  </div>
			</div>
			<div class="form-item" >
				<label class="form-label"><span class="red">*</span>仓库保险费率</label>
				<div class="form-input line" style="position: relative;">
                    <input type="number" name="safe" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input" required>
					<div >%</div>
					<div class="tips">*仓储总金额的百分比</div>
				</div>
			</div>
			<div class="form-item">
				<label class="form-label"><span class="red">*</span>商品折扣</label>
				<div class="form-input line">
					<input type="checkbox" name="type" lay-skin="primary" title="参加会员折扣" value="1">
					<a href="">管理会员卡</a>
				</div>
			</div>
			<div class="form-item">
					<label class="form-label"><span class="red">*</span>默认入仓</label>
					<div class="form-input">
						<input type="radio" name="label" value="1" title="默认入仓" checked="">
						<input type="radio" name="label" value="0" title="默认不入仓">
					</div>
				</div>
		<div class="layui-form-item">
			<div class="layui-input-block">
				<button class="layui-btn layui-btn-normal" type="submit">确认提交</button>
				<button type="button" class="layui-btn layui-btn-primary" onClick="javascript :history.back(-1);">返回</button>
			</div>
		</div>
	</form>

	{/block}

	<!--_footer 作为公共模版分离出去-->
	{include file="template/_footer" /}
	<!--/_footer 作为公共模版分离出去-->

	<!--请在下方写此页面业务相关的脚本-->
	{block name="bottom"}

	<script type="text/javascript">
		layui.config({
			base: "js/"
		}).use(['form', 'layer', 'jquery', 'laypage', 'upload'], function() {
			var form = layui.form(),
				$ = layui.jquery;
			form.render();
			var templet=[];
                $.ajax({
                        type: "POST",
                        url:"{:url('admin/StoreHouse/store_house_unit')}",
						async:false,
                        data: {
                            
                        },
                        success: function (data) {
                            data = eval("(" + data + ")");
                            templet=data.data;
                           
                        },
                        error: function (data) {
                            console.log(data)
                        }
                    });
			var danwei='';
			danwei+='<div class="form-input line" style="position: relative;">';
			danwei+='<select name="unit[]"  class="role_list"  lay-filter="danwei" >';
			danwei+='<option value="">请选择</option>';
			for(var i=0;i<templet.length;i++){
				danwei+='<option value="'+templet[i]+'">'+templet[i]+'</option>';
			}

			danwei+='</select>';
			danwei+='<input type="text" name="cost[]" lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input" required>';
			danwei+='<div class=""> /元/天</div>';
			danwei += ' <img src="__STATIC__/admin/index/img/X.png" alt="" class="delect_img" style="right:300px">';
			danwei+='</div>';
         $(".add_danwei").click(function(){
			$(this).before(danwei);
			form.render();
		 })
		 $(".danwei_content").on('click', ".delect_img", function () {
				 $(this).parent().remove();
			 })
			 form.on('select(danwei)', function(data){
				 var num=0;
				 var danwei1='';
				var selected=$(".danwei_content select option:selected");
				for(var i=0;i<selected.length;i++){
				
                   if(data.value==selected[i].value){
					   num++;
				
				   }
				 
				}
				console.log(num);
				if(num>1){
						$(this).parent().parent().siblings("select"). children().remove();
					
						danwei1+='<option value="">请选择</option>';
						for(var j=0;j<templet.length;j++){
							danwei1+='<option value="'+templet[j]+'">'+templet[j]+'</option>';
						}
						console.log(danwei1);
						$(this).parent().parent().siblings("select").append(danwei1);
						alert("相同的单位不能有两个仓库保管费")
							form.render();
						
				   }
			
			})
		});
	</script>

	{/block}

</body>

</html>