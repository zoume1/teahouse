{include file="template/_meta" /}
<title></title>
</head>

{block name="css"}

<style type="text/css">
	body {
		background: #fff;
	}

	#page {
		width: 97%;
		height: 50px;
		line-height: 50px;
		border: solid 1px #E2E2E2;
		padding-left: 50px;
		background: #FDFDFE;
	}

	.on {
		color: #21A5FA !important;
		border-bottom: solid 3px #21A5FA;
	}

	.static_btus1 {
		width: 100px;
		height: 30px;
		line-height: 30px;
		text-align: center;
		cursor: pointer;
		margin-left: 10px
	}

	/* 没申请 */
	.not_apply {
		color: #BCBCBC;
		border: solid 1px #BCBCBC;
		border-radius: 3px;
	}

	/* 申请 */
	.apply {
		color: #FF9900;
		border: solid 1px #FF9900;
		border-radius: 3px;
	}

	/* 已开票
	 */
	.applyed {
		color: #669900;
		border: solid 1px #669900;
		border-radius: 3px;
	}

	.static_btus2 {
		width: 100px;
		height: 30px;
		line-height: 30px;
		color: #0099FF;
		cursor: pointer;
		text-align: center;
	}

	.distribution_list {
		margin-bottom: 10px;
		border-bottom: solid 1px #D7D7D7;
	}

	.distribution_list ul {
		display: flex;
		align-items: center;
	}


	.line {
		justify-content: center;
	}


	.distribution_list a {
		font-size: 14px;
		padding: 9px;
		color: #5E5E5E;
	}

	.distribution_list ul li {}

	.static_btus {
		border-radius: 5px;
	}


	.state {
		width: 100px;
		height: 30px;
		line-height: 30px;
		border-radius: 4px;
		/* background: #007AFF; */
		color: #fff;
		margin: 0 auto;
	}

	/*
     * 弹窗
     4*/

	.popup {
		width: 100%;
		height: 100%;
		position: fixed;
		background: rgba(0, 0, 0, 0.5);
		z-index: 99999;
		display: flex;
		justify-content: center;
		align-items: center;
		border: solid 1px #D7D7D7;
		box-sizing: border-box;
	}

	.submit_btns {
		width: 100px;
		height: 38px;
		color: #fff;
		background: #169BD5;
		border-radius: 10px;
	}

	.popup_doms {
		width: 790px;
		height: 400px;
		background: #fff;
	}
    
	.popup_doms1 {
		width: 900px;
		background: #fff;
	}

	.popup_content {
		padding: 20px;
	}

	.popup_title {
		height: 40px;
		line-height: 40px;
		color: #66662B;
		background: #EEF7EA;
		padding-left: 20px;
	}

	.span {
		display: inline-block;
		width: 80px;
		text-align: left;
		margin-right: 20px;
	}

	.repany .layui-input {
		width: 530px;
	}

	.repany {
		margin-bottom: 10px;
	}

	.operation {
		display: flex;
		align-items: center;
	}

	.chat {
		height: 210px;
	}

	.danhao {
		width: 200px;
		margin-right: 10px;
	}

	.operation select {
		width: 130px;
		height: 40px;
		border-color: #ABADB3;
		color: #000;
		background: #fff;
	}

	.operation div {
		margin-right: 10px;
	}

	.tip {
		color: red;
		margin-left: 200px;
	}

	.noshow {
		display: none;
	}

	.popup_title {
		position: relative;
	}

	.popup_x {
		width: 25px;
		position: absolute;
		right: 12px;
		top: -4px;
	}

	.repay_tip {
		display: inline-block;
		width: 100px;
		height: 35px;
		text-align: center;
		line-height: 35px;
		color: #fff;
		background: #669900;
		border-radius: 5px;
	}

	.button {
		width: 100px;
		line-height: 30px;
		text-align: center;
		border: 1px solid #a2a2a2;
		border-radius: 5px;
		cursor: pointer;
	}

	.button_all {
		display: flex;
		justify-content: space-around;
		margin-top: 30px;
		margin-bottom: 30px;
	}

	/* .quxiao {} */

	.daying {
		background: rgb(22, 155, 213);
		color: #fff;
	}


	/*
     * 弹窗end
		 */
	/* .seach_button_all {} */

	.seach_button {
		border-radius: 4px;
		display: inline-block;
		width: 80px;
		line-height: 30px;
		color: #fff;
		text-align: center;
	}

	.all0 {
		background: #F4FBFF;
		color: #999;
	}

	.all1 {
		background: #CC3366;
	}

	.all2 {
		background: #CC00CC;
	}

	.all3 {
		background: #FF0000;
	}

	.all4 {
		background: #669900;
	}

	.all5 {
		background: #A1A1A1;
		color: #000;
	}

	/* 状态颜色 */
	/* 待付款 */
	.color1 {
		background: #CC3366;
	}

	/* 待发货 */
	.color2 {
		background: #CC00CC;
	}

	/* 已发货 */
	.color3 {
		background: #FF0000;
	}

	/* 已完成 */
	.color4 {
		background: #669900;
	}

	/* 已关闭 */
	.color5 {
		background: #A1A1A1;
	}

	/* 已退款 */
	.color6 {
		background: #CC9900;
	}

	/* 已入仓 */
	.color7 {
		background: #0000CC;
	}


	/*  待发货*/
	.color8 {
		background: #CC00CC;
	}

	/* 已取消 */
	.color9 {
		background: #831626;
	}

	.chenge_money {
		display: flex;
		margin-left: 10px;
		text-align: center;
		padding-top: 20px;
		border-top: 2px dashed rgb(223, 223, 223)
	}

	.danwei {
		position: absolute;
		top: 10px;
		left: 170px;

	}
	td.three>div,
	td.four>div,
	td.five>div{
		border-bottom: 1px solid #e2e2e2;
	}

	td.four>div {
		line-height: 50px;
		white-space: nowrap;
		max-width: 450px;
		text-overflow: ellipsis;
		overflow: hidden;
	}

	td.three>div:last-of-type, 
	td.four>div:last-of-type, 
	td.five>div:last-of-type{
		border: 0;
	}

	td {
		padding: 4px 0 !important;
	}

	td img {
		width: 50px;
		height: 50px;
	}

	.popup_content1 {
		padding: 0 15px;
	}

	.popup_content1>td {
		width: 120px;
	}

	.popup_t {
		font-size: 18px;
		font-weight: 500;
		color: black;
		line-height: 40px;
		display: flex;
		justify-content: space-between;
		padding: 0 15px;
		align-items: flex-end;
	}
	
</style>

{/block}

<body>

	{block name="content"}
	<div class="popup popup_one noshow">
		<div class="popup_doms">
		
			<div class="popup_title">
				处理回复（个人信息处有提示信息）
					<div class="popup_x">
				<img src="__STATIC__/admin/index/img/X.png"/>
			</div>
			</div>
			<div class="popup_content">
					<div class="repany">
						<span class="span">官方批注</span>
						<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入处理备注"
							class="layui-input Information">
						<span class="repay_tip">批注</span>
					</div>
					<div class="chat"></div>
					<div class="operation"></div>
					<div class="chenge_money" data-id="">
						<div style="position:relative; margin-right: 100px;">
							订单金额 <input type="text" name="amount" readonly autocomplete="off" class="layui-input"
								style="width:150px;"><span class="danwei">元</span>
						</div>
						<div style="position:relative">
							修改订单金额 <input type="text" name="changePriceVal" required lay-verify="required" placeholder="请输入"
								autocomplete="off" class="layui-input" style="width:190px;"><span class="danwei"
								style="left: 240px;">元</span>
						</div>
						<div style="margin-left:45px;">
							<button class="layui-btn changePrice"
								style="background-color:rgb(22, 155, 213);border-radius: 5px;">确定改价</button>
						</div>
					</div>
				</div>
		</div>
	</div>
    <!-- <div class="popup popup_two noshow">
		<div class="popup_doms">
		   <div class="popup_title">
				处理回复（个人信息处有提示信息）
					<div class="popup_x">
				<img src="__STATIC__/admin/index/img/X.png"/>
				</div>
			</div>
			<div class="popup_content">
				<div class="repany">
					<span class="span">官方回复</span>
					<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入处理备注" class="layui-input">
				</div>
				<div class="chat">
					<div class="chat_list">
						<span class="span">20180811</span>
						<span>官方备注已用户要求高可顺非邮寄</span>
					</div>
				</div>
				<div class="operation">
					<div class="select_static">
						<span class="operation_title">选择操作</span>
						<select name="">
							<option value="" selected="">请选择</option>
							<option value="1">已退款</option>
						</select>
					</div>
					<div class="select_courier"  >
						<span class="operation_title">选择退款金额</span>
					    <input type="text" name="" lay-verify="title" autocomplete="off" placeholder="输入退款金额" class="layui-input danhao" >
					</div>
					
					<button type="button" class="submit_btns">确定</button>
				</div>
			</div>
		</div>
	</div> -->

	<div class="childrenBody">
		{include file="template/_top" /}
		<!--<div class="distribution_list">-->
			<!--<ul>-->
                <!--<li>-->
                    <!--<a href="{:url('admin/StoreHouse/stores_divergence')}"   >订单入仓</a>-->
                <!--</li>-->
                <!--<li>-->
                    <!--<a href="{:url('admin/StoreHouse/stores_divergence_out')}" class="on">订单出仓</a>-->
                <!--</li>-->

			<!--</ul>-->
		<!--</div>-->
		<blockquote class="layui-elem-quote news_search">
			<form class="layui-form" action="{:url('admin/StoreHouse/stores_divergence_out_search')}">
				<div class="seach">
					<div class="seach_list">
						<div class="seach_laber">请搜索</div>
						<div class="seach_input">
							<input type="text" name="search_name" lay-verify="title" autocomplete="off" placeholder="订单编号/商品名称/用户账号" class="layui-input">

						</div>
					</div>
					<div class="seach_list">
						<div class="seach_laber">开始时间</div>
						<div class="seach_input">
							<span class="time"><input type="text" class="text datetimepicker layui-input" readonly="readonly" id="beginTime" value=""   name="date_min">
							</span>
						</div>
					</div>
					<div class="seach_list">
						<div class="seach_laber">结束时间</div>
						<div class="seach_input">
							<span class="time"><input type="text" class=" text datetimepicker layui-input" readonly="readonly" id="endTime" value=""  name="date_max" ></span>
						</div>
					</div>
					<button class="layui-btn" type="submit" id="seach">立即搜索</button>
				</div>

			</form>
		</blockquote>

		<div class="layui-form news_list">
			<table class="layui-table">
				<colgroup>
					<col width="3%">
				</colgroup>
				<thead>
					<tr>
						<th><input type="checkbox" sname="" lay-skin="primary" lay-filter="allChoose" id="id"></th>
						<th>订单编号</th>
						<th>商品名称</th>
						<th>用户账号</th>
						<th>仓储仓库名</th>
						<th>锁定到期日期</th>
						<th>出仓数量</th>
                        <th>出仓时间</th>
                        <th>出仓运费</th>
						<th>操作</th>
					</tr>
				</thead>
				<tbody class="news_content">
						{if !empty($stores_divergences)}{volist name="stores_divergences" id="value"}
					<tr>
						<td><input type="checkbox" sname="" lay-skin="primary" lay-filter="choose"data-id="{$value.id}"></td>
						<td>{$value.out_order_number}</td>
						<td>{$value.parts_goods_name}</td>
						<td>{$value.user_account_name}</td>
						<td>{$value.name}</td>
						<td>{$value.end_time|date="Y-m-d H:i",###}</td>
						<td>{$value.store_number}</td>
                        <td>{$value.pay_time|date="Y-m-d H:i",###}</td>
						<td>￥{$value.house_charges}</td>
						<td>
								<div class="line">
										<div class="static_btus" data-id="{$value.id}" data-value="{$value.status}">
											{$value.status|show_order_status}
										</div>
									</div>
						</td>
					</tr>
					{/volist}{/if}
				</tbody>
			</table>
			<div id="page">
				<div class="opation up-form-select" style="width: 200px; float: left;">
					<select name="" style="color: #C1A5A5; border-color: #E4E4E4;height: 30px;">
						<option check="" value="0">请选择</option>
						<option value="1">批量删除</option>
					</select>
				</div>
				<div style="float: left; height: 52px;line-height: 52px; margin-left: 20px;">
					<button type="button" id="opration_btu" style="width: 60px; background: #fff; color: #333333;border:#CCCCCC solid 1px;height: 38px;line-height: 38px;">确定
					</button>
				</div>
			</div>
			{if !empty($stores_divergences)}
			{$stores_divergences->render()}
			{/if}

		</div>

	</div>

	{/block}

	<!--_footer 作为公共模版分离出去-->
	{include file="template/_footer" /}
	<!--/_footer 作为公共模版分离出去-->

	<!--请在下方写此页面业务相关的脚本-->
	{block name="bottom"}
	<script type="text/javascript">
		layui.config({
			base: "js/"
		}).use(['form', 'layer', 'jquery', 'laypage'], function() {
			var form = layui.form(),
				layer = parent.layer === undefined ? layui.layer : parent.layer,
				laypage = layui.laypage,
				$ = layui.jquery;
			var vals = $("input").data("id");
			//点击操作确认按钮
			var data_id = [];
			$("#opration_btu").click(function() {
				var opration_val = $(".opation select option:selected").val();
				if(opration_val == 0) {
					layer.alert('请选择操作', {
						skin: 'layui-layer-molv' //样式类名
							,
						closeBtn: 0
					});
				} else if(opration_val == 1) {
					layer.confirm('你确认要删除吗？', {
						btn: ['确认', '取消'] //按钮
					}, function(index) {
						layer.close(index);
						var child = $("tbody").find('input[type="checkbox"]:not([name="show"]):checked');
						for(var i = 0; i < child.length; i++) {
							data_id.push($(child[i])[0].dataset.id);
						}
						$.ajax({
							type: "POST",
							url: "{:url('admin/Category/dels')}",
							data: {
								"id": data_id,
							},
							success: function(data) {
								console.log("成功");
								console.log(data);
								var data = $.parseJSON(data);
								layer.alert(data.info, {
									skin: 'layui-layer-molv' //样式类名
										,
									closeBtn: 0
								});
								location.reload();
								data_id.splice(0, data_id.length);
							},
							error: function(data) {
								var data = $.parseJSON(data);
								layer.alert(data.info, {
									skin: 'layui-layer-molv' //样式类名
										,
									closeBtn: 0
								});
								console.log(data);
								console.log("错误");
								data_id.splice(0, data_id.length);
							}
						});
					});

				}

			});

			//全选
			form.on('checkbox(allChoose)', function(data) {
				var child = $(data.elem).parents('table').find('tbody input[type="checkbox"]:not([name="show"])');
				child.each(function(index, item) {
					item.checked = data.elem.checked;
				});
				form.render('checkbox');
			});

			//通过判断文章是否全部选中来确定全选按钮是否选中
			form.on("checkbox(choose)", function(data) {
				var child = $(data.elem).parents('table').find('tbody input[type="checkbox"]:not([name="show"])');
				var childChecked = $(data.elem).parents('table').find('tbody input[type="checkbox"]:not([name="show"]):checked')
				if(childChecked.length == child.length) {
					$(data.elem).parents('table').find('thead input#allChoose').get(0).checked = true;
				} else {
					$(data.elem).parents('table').find('thead input#allChoose').get(0).checked = false;
				}
				form.render('checkbox');
			})

			form.on('switch(isShow)', function(data) {
				if($(this).val() == 0) {
					$(this).val(1);
				} else {
					$(this).val(0);
				}
				var vals = data.value;
				var id = $(this).data("id");
				var status = $(this).val();
				$.ajax({
					type: "POST",
					url: "{:url('')}",
					data: {
						"id": id,
						"status": status
					},
					success: function(data) {
						console.log("成功")
					},
					error: function(data) {
						console.log("错误")
					}
				});

			})
		})
		$(".static_btus").click(function(){
			$(".popup_two").removeClass("noshow");
		});
			$(".popup_x").click(function(){
			$(".popup_two").addClass("noshow");
			$(".popup").addClass("noshow");
		});
		
		$(".static_btus").click(function () {
			var _this = this;
			var name = $(this).find('.state').text();
			if (name == '已入仓') {
				window.location.href = "/admin/stores_divergence/data-id/152";
				return false;
			}
			// 订单金额
			var amount = +$(this).parents('tr').children('td.am').text();
			$('input[name=amount]').val(amount);
			var data_id = $(this).data("id");    //订单id
			var way = 0;
			$(".operation").data("value", data_id);
			$(".repay_tip").data("value", data_id);
			var data_value = $(this).data("value");    //订单状态
			$(".operation").empty();
			$(".chat").empty();
			//获取批注
			$.ajax({
				type: "POST",
				url: "{:url('admin/Notification/notice_index')}",
				data: {
					"order_id": data_id,
				},
				async: false,
				success: function (data) {
					var data = JSON.parse(data);
					console.log(data)
					way = data.data.order_type;   //邮寄方式    
					for (var i = 0; i < data.data.datas.length; i++) {
						var dhtm0 = "";
						dhtm0 += '<div class="chat_list">';
						dhtm0 += '	<span class="span">' + timestampToTime(data.data.datas[i].create_time) + '</span>';
						dhtm0 += '<span>' + data.data.datas[i].information + '</span>';
						dhtm0 += '</div>';
						$(".chat").append(dhtm0);
					}
				},
				error: function (data) {

				}
			});
			//获取订单的信息
			var express = 0;
			var express_name = 'EMS';
			$.ajax({
				type: "POST",
				url: "{:url('admin/Order/order_information_return')}",
				data: {
					"order_id": data_id,
				},
				async: false,
				success: function (data) {
					var data = JSON.parse(data);
					console.log(data)
					way = data.data.order_type;   //邮寄方式  
					express = data.data.courier_number;
					express_name = data.data.express_name_ch;
					
					// $(".operation").find('.curier').value(express);
					// $(".operation").find('.danhao').val(express_name);
				},
				error: function (data) {

				}
			});
			var dhtml1 = "";
			dhtml1 += '<div class="select_static">';
			dhtml1 += '<span class="operation_title">选择操作</span>';
			dhtml1 += '<select name="" class="operation_select">';
			dhtml1 += '<option value="1" selected="">已发货</option>';
			dhtml1 += '</select>';
			dhtml1 += '</div>';
			dhtml1 += '<div class="select_courier">';
			dhtml1 += '<span class="operation_title">选择快递</span>';
			dhtml1 += '<select name="" class="curier">';
			dhtml1 += '<option value="ems">EMS</option>';
			dhtml1 += '<option value="youzhengguonei">邮政包裹/平邮</option>';
			dhtml1 += '<option value="bjemstckj">北京EMS</option>';
			dhtml1 += '<option value="shunfeng">顺丰</option>';
			dhtml1 += '<option value="shentong">申通</option>';
			dhtml1 += '<option value="yuantong">圆通 </option>';
			dhtml1 += '<option value="zhongtong">中通</option>';
			dhtml1 += '<option value="huitongkuaidi">百世汇通</option>';
			dhtml1 += '<option value="baishiwuliu">百世物流</option>';
			dhtml1 += '<option value="yunda">韵达</option>';
			dhtml1 += '<option value="zhaijisong">宅急送</option>';
			dhtml1 += '<option value="tiantian">天天</option>';
			dhtml1 += '<option value="debangwuliu">德邦</option>';
			dhtml1 += '<option value="guotongkuaidi">国通</option>';
			dhtml1 += '<option value="zengyisudi">增益</option>';
			dhtml1 += '<option value="suer">速尔</option>';
			dhtml1 += '<option value="ztky">中铁物流</option>';
			dhtml1 += '<option value="zhongtiewuliu">中铁快运</option>';
			dhtml1 += '<option value="ganzhongnengda">能达</option>';
			dhtml1 += '<option value="youshuwuliu">优速</option>';
			dhtml1 += '<option value="quanfengkuaidi">全峰</option>';
			dhtml1 += '<option value="quanfengkuaidi">其他物流</option>';

			dhtml1 += '</select>';
			dhtml1 += '</div>';
			dhtml1 += '<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入单号" class="layui-input danhao"  >';
			dhtml1 += '<button type="button" class="submit_btns" data-id="">确认发货</button>';
			var dhtml2 = "";

			dhtml2 += '<div class="select_courier">';
			dhtml2 += '<span class="operation_title">选择快递</span>';
			dhtml2 += '<select name="" class="curier">';
			// dhtml2 += '<option value="ems">EMS</option>';
			// dhtml2 += '<option value="youzhengguonei">邮政包裹/平邮</option>';
			// dhtml2 += '<option value="bjemstckj">北京EMS</option>';
			// dhtml2 += '<option value="shunfeng">顺丰</option>';
			// dhtml2 += '<option value="shentong">申通</option>';
			// dhtml2 += '<option value="yuantong">圆通 </option>';
			// dhtml2 += '<option value="zhongtong">中通</option>';
			// dhtml2 += '<option value="huitongkuaidi">百世汇通</option>';
			// dhtml2 += '<option value="baishiwuliu">百世物流</option>';
			// dhtml2 += '<option value="yunda">韵达</option>';
			// dhtml2 += '<option value="zhaijisong">宅急送</option>';
			// dhtml2 += '<option value="tiantian">天天</option>';
			// dhtml2 += '<option value="debangwuliu">德邦</option>';
			// dhtml2 += '<option value="guotongkuaidi">国通</option>';
			// dhtml2 += '<option value="zengyisudi">增益</option>';
			// dhtml2 += '<option value="suer">速尔</option>';
			// dhtml2 += '<option value="ztky">中铁物流</option>';
			// dhtml2 += '<option value="zhongtiewuliu">中铁快运</option>';
			// dhtml2 += '<option value="ganzhongnengda">能达</option>';
			// dhtml2 += '<option value="youshuwuliu">优速</option>';
			// dhtml2 += '<option value="quanfengkuaidi">全峰</option>';
			// dhtml2 += '<option value="quanfengkuaidi">其他物流</option>';
			dhtml2 += '<option value="' + express_name + '">' + express_name + '</option>';
			dhtml2 += '</select>';
			dhtml2 += '</div>';
			$('.tip').remove();
			var tip = '';
			if (data_value == '8' || data_value == 0) {    //已完成
				dhtml2 += '<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入单号" readonly class="layui-input danhao" value="' + express + '" style="width:58%;"  >';
			} else {
				dhtml2 += '<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入单号" class="layui-input danhao" value="' + express + '" style="width:58%;"  >';
				dhtml2 += '<button type="button" class="submit_btns" data-id="">修改单号</button>';

			}

			var dhtml3 = "";
			dhtml3 += '<div class="select_courier">';
			dhtml3 += '<span class="operation_title">选择快递</span>';
			dhtml3 += '<select name="" class="curier">';
			dhtml3 += '<option value="ems">EMS</option>';
			dhtml3 += '<option value="youzhengguonei">邮政包裹/平邮</option>';
			dhtml3 += '<option value="bjemstckj">北京EMS</option>';
			dhtml3 += '<option value="shunfeng">顺丰</option>';
			dhtml3 += '<option value="shentong">申通</option>';
			dhtml3 += '<option value="yuantong">圆通 </option>';
			dhtml3 += '<option value="zhongtong">中通</option>';
			dhtml3 += '<option value="huitongkuaidi">百世汇通</option>';
			dhtml3 += '<option value="baishiwuliu">百世物流</option>';
			dhtml3 += '<option value="yunda">韵达</option>';
			dhtml3 += '<option value="zhaijisong">宅急送</option>';
			dhtml3 += '<option value="tiantian">天天</option>';
			dhtml3 += '<option value="debangwuliu">德邦</option>';
			dhtml3 += '<option value="guotongkuaidi">国通</option>';
			dhtml3 += '<option value="zengyisudi">增益</option>';
			dhtml3 += '<option value="suer">速尔</option>';
			dhtml3 += '<option value="ztky">中铁物流</option>';
			dhtml3 += '<option value="zhongtiewuliu">中铁快运</option>';
			dhtml3 += '<option value="ganzhongnengda">能达</option>';
			dhtml3 += '<option value="youshuwuliu">优速</option>';
			dhtml3 += '<option value="quanfengkuaidi">全峰</option>';
			dhtml3 += '<option value="quanfengkuaidi">其他物流</option>';
			dhtml3 += '</select>';
			dhtml3 += '</div>';

			dhtml3 += '<input type="text" name="" lay-verify="title" autocomplete="off" placeholder="请输入单号" class="layui-input danhao"  style="width:58%;" >';
			dhtml3 += '<button type="button" class="submit_btns" data-id="">确认发货</button>';
			tip += '<text class="tip" >注：选择顺丰时单号前要加：SF</text>';
			// var dhtml2="";
			// dhtml2+='<div class="select_static">';
			// dhtml2+='<span class="operation_title">选择操作</span>';
			// dhtml2+='<select name="" class="operation_select">';
			// dhtml2+='<option value="" selected="">请选择</option>';
			// dhtml2+='<option value="1">已退款</option>';
			// dhtml2+='</select>';
			// dhtml2+='</div>';
			// dhtml2+='<div class="select_courier"  >';
			// dhtml2+='<span class="operation_title">选择退款金额</span>';
			// dhtml2+=' <input type="text" name="" lay-verify="title" autocomplete="off" placeholder="输入退款金额" class="layui-input danhao" >';
			// dhtml2+='</div>';
			// dhtml2+='<button type="button" class="submit_btns"  data-id="">确定</button>';
			// var dhtml3="";
			// dhtml3+='<button type="button" class="submit_btns"  data-id="">确定</button>';
			if (data_value == 2 || data_value == 3) {   //代发货
				$('.chenge_money').hide();
				$(".operation").append(dhtml3);
				$(".popup_content").append(tip);
				$(".operation").data("id", data_value);
			} else if (data_value == 4 || data_value == 5 || data_value == 6 || data_value == 7) {
				$('.chenge_money').hide();
				$(".operation").append(dhtml2);

				$(".operation").data("id", data_value);
			} else if (data_value == '8' || data_value == 0) {    	  //已完成
				$('.chenge_money').hide();
				$(".operation").append(dhtml2);

				$(".operation").data("id", data_value);
			} else {
				$('.chenge_money').show();
			}
			$(".popup_one").removeClass("noshow");

			$(".operation").on("click", ".submit_btns", function () {
			$(".popup").addClass("noshow");
			var repay = $(".repay").val();
			var id = $(this).parent(".operation").data("id");   //订单状态
			var value = $(this).parent(".operation").data("value");   //订单的id

			//    快递选择
			var curier = $(".curier option:selected").val();
			var curier2 = $(".curier option:selected").text();
			//    操作选择
			var operation_select = $(".operation_select option:selected").val();
			//    快递单号
			var danhao = $(".danhao").val();
			if (danhao != '') {  //判断单号
				//根据id判断订单的类型
				if (id == '2' || id == '4') {     //待发货----已发货
					$.ajax({
						type: "POST",
						url: "{:url('admin/StoreHouse/stores_order_confirm_shipment')}",
						data: {
							"order_id": value,
							"courier_number": danhao,
							"status": 4,
							"express_name": curier,
							"express_name_ch": curier2
						},
						success: function (data) {
							location.reload();
							var data = eval('(' + data + ')');
							console.log(data);

						},
						error: function (data) {

						}
					});
				} else {
					$.ajax({
						type: "POST",
						url: "{:url('admin/StoreHouse/stores_order_confirm_shipment')}",
						data: {
							"order_id": value,
							"courier_number": danhao,
							"status": 5,
							"express_name": curier
						},
						success: function (data) {
							location.reload();
							var data = eval('(' + data + ')');
							console.log(data);

						},
						error: function (data) {

						}
					});
				}

			}
			else {
				alert("请输入单号");
			}

		});
		});
	</script>

	{/block}

</body>

</html>